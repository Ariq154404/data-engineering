[2023-09-22T00:26:32.844+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: job_extraction_dag.extract_result_for_jobs_task manual__2023-09-22T00:26:29.762755+00:00 [queued]>
[2023-09-22T00:26:32.850+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: job_extraction_dag.extract_result_for_jobs_task manual__2023-09-22T00:26:29.762755+00:00 [queued]>
[2023-09-22T00:26:32.852+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 2
[2023-09-22T00:26:32.860+0000] {taskinstance.py:1350} INFO - Executing <Task(PythonOperator): extract_result_for_jobs_task> on 2023-09-22 00:26:29.762755+00:00
[2023-09-22T00:26:32.866+0000] {standard_task_runner.py:57} INFO - Started process 212 to run task
[2023-09-22T00:26:32.869+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'job_extraction_dag', 'extract_result_for_jobs_task', 'manual__2023-09-22T00:26:29.762755+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/test.py', '--cfg-path', '/tmp/tmpvulhh3c4']
[2023-09-22T00:26:32.872+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask extract_result_for_jobs_task
[2023-09-22T00:26:32.887+0000] {logging_mixin.py:149} WARNING - /home/***/.local/lib/python3.9/site-packages/***/settings.py:188 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-09-22T00:26:32.916+0000] {task_command.py:410} INFO - Running <TaskInstance: job_extraction_dag.extract_result_for_jobs_task manual__2023-09-22T00:26:29.762755+00:00 [running]> on host d9ed0bedf201
[2023-09-22T00:26:32.974+0000] {taskinstance.py:1568} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='job_extraction_dag' AIRFLOW_CTX_TASK_ID='extract_result_for_jobs_task' AIRFLOW_CTX_EXECUTION_DATE='2023-09-22T00:26:29.762755+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-09-22T00:26:29.762755+00:00'
[2023-09-22T00:26:34.341+0000] {logging_mixin.py:149} INFO - JOOBBS [{'employer_name': 'COWRKS', 'job_employment_type': 'FULLTIME', 'job_title': 'Full-time / Senior Data Analyst (Remote)', 'job_apply_link': 'https://ca.linkedin.com/jobs/view/full-time-senior-data-analyst-remote-at-cowrks-3724803980', 'job_description': 'We are looking for analysts with broader skill sets that include the ability to quickly understand the business context of a wide variety of products, and the ability to help design more scalable and repeatable solutions to complex problems. Please expect an interview process which assesses both technical skills and broader business acumen.\n\nIn this role, you will:\n• Act as a point of contact for confidential data requests from the teams that respond to regulators, partners, and litigations\n• Interface with in-house and outside counsel teams to understand and deliver repeatable data access within defined timelines\n• Focus on designing self service tools that eliminate the need for multiple Ad-Hoc requests related to the same subject matter\n• Take ownership of proactively documenting team’s knowledge to enable others to quickly solve the next challenge\n• Partner with the broader Data Science team to automate QA requirements for our self service tools (dabble in test driven design!)\n• Identify data and process improvement opportunities; propose solutions for the future and work cross functionally to implement those recommendations\n• Perform analyses on large data sets to provide insights and actionable recommendations that will help satisfy various legal, regulatory, and compliance requests\n• Work closely with Data Engineers and other cross-functional teams to build scalable data infrastructure to quickly satisfy a wide range of requests from our legal and compliance teams\n• Be a SME both technically and functionally, identifying actionable insights that inform business processes and how we respond to regulatory requests\n• Maintain confidentiality regarding the work you do, and the nature of the requests\n\nQualifications\n• 1+ years of experience as a Data Analyst with 2+ years of experience in a compliance, regulatory, or legal environment\n• Ability to communicate and partner with legal, business, and technical teams clearly, and translate complex information needs into specific action items\n• Experience gathering business requirements, creating ad-hoc reports, and designing scalable solutions to automate those ad-hoc reports\n• Experience querying, analyzing, and reporting large data-sets to answer complex business questions\n• Technical skills must include Advanced SQL, Data Visualization via tools like Tableau/Looker/Mode\n• Creative data visualizer\n• Able to create a report without use of Excel/GSheet\n• Effective time management skills with the ability to adjust to multiple demands, shifting priorities and rapid change\n• Strong ability to break down large tasks into smaller, achievable milestones\n• Strong ability to both communicate and negotiate expectations for your projects with stakeholders\n• Proven ability to work both individually and in a team environment and display a positive business presence and sound judgment with management and external personnel\n\nPowered by Webbtree', 'job_posted_at_timestamp': 1695329880, 'job_posted_at_datetime_utc': '2023-09-21T20:58:00.000Z'}, {'employer_name': 'CB Canada', 'job_employment_type': 'FULLTIME', 'job_title': 'Data Analyst', 'job_apply_link': 'https://ca.bebee.com/job/20230921-22d0c567f64cdcc9a542226553d15fff', 'job_description': "The opportunity\n\nOur Data Solutions team in Toronto is looking for a new Data Analyst to join us in a hybrid position. You will be part of a highly motivated, multi-disciplinary team of professionals focusing on developing key commercial and residential trends across Canada. You will leverage our proprietary data to provide market intelligence that will guide internal and external decision-making. You will support the generation of monthly and quarterly reports related to Canada's housing markets by preparing the background files and associated analytics. You will liaise and collaborate with industry professionals and information partners to achieve objectives and maintain the consistent and timely provision of market trends.\n\nWhat's in it for you\n\nExposure and career growth. You will be part of an organization that works on an exciting range of commercial property projects across the country, a place recognized at the top of our industry. You will gain access to our proprietary databases used by the global industry and gain insights into our services and the Canadian development market. You will be mentored and grow your knowledge as you foster relationships with internal team members and have the chance to work on a variety of deliverables from research to data entry, from report writing to drafting property descriptions.\n\nWhat you will do:\n• Analyze. You will develop quality assurance procedures for data, evaluating for completion and accuracy. You will process and analyze data sets, synthesize information for market research, create dashboards, and develop models and charts. You will play a key role in expanding our commercial and residential real estate market analytics.\n• Collaborate. You will work with the research consulting and marketing teams in developing, visualizing and writing periodic market trend reports covering various real estate sectors. You will support the Manager, Research Insights, with the market forecast initiative.\n• Grow your knowledge. You will attend industry events and meetings, reviewing professional publications, establishing personal networks, and benchmark best practices.\n\nYou will have:\n• The education and experience. You have a university degree or college diploma in Urban Planning, Geography, Economics, Finance, Business, Real Estate or a related field and 1+ years of experience in real estate research. Ideally, you have exposure to both the Canadian housing market and the commercial real estate or development industry. You have professional writing skills to competently author trend reports.\n• The technical skills. You are proficient in MS Office and Tableau. You have excellent research, and analytical skills. You can process and analyze data sets, synthesize information for market research, create dashboards, and develop models and charts.\n• The drive. You can take the initiative and be resourceful, operating with a high degree of integrity, honesty, and ethics.", 'job_posted_at_timestamp': 1695264494, 'job_posted_at_datetime_utc': '2023-09-21T02:48:14.000Z'}]
[2023-09-22T00:26:34.358+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/test.py", line 72, in extract_result_for_jobs
    llm=load_llm('gpt-3.5-turbo')
  File "/opt/airflow/dags/test.py", line 29, in load_llm
    llm=ChatOpenAI(model=model_name,temperature = 0,
  File "/home/airflow/.local/lib/python3.9/site-packages/langchain/load/serializable.py", line 75, in __init__
    super().__init__(**kwargs)
  File "/home/airflow/.local/lib/python3.9/site-packages/pydantic/main.py", line 341, in __init__
    raise validation_error
pydantic.error_wrappers.ValidationError: 1 validation error for ChatOpenAI
__root__
  Could not import openai python package. Please install it with `pip install openai`. (type=value_error)
[2023-09-22T00:26:34.385+0000] {taskinstance.py:1368} INFO - Marking task as UP_FOR_RETRY. dag_id=job_extraction_dag, task_id=extract_result_for_jobs_task, execution_date=20230922T002629, start_date=20230922T002632, end_date=20230922T002634
[2023-09-22T00:26:34.396+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 2 for task extract_result_for_jobs_task (1 validation error for ChatOpenAI
__root__
  Could not import openai python package. Please install it with `pip install openai`. (type=value_error); 212)
[2023-09-22T00:26:34.450+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2023-09-22T00:26:34.463+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
